#include <Wire.h>
#include <SPI.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define OLED_MOSI  7 //D1
#define OLED_CLK   8 //D0
#define OLED_DC    5 //DC
#define OLED_CS    4 //CS
#define OLED_RESET 6 //RES
#define CONTROL_A 9
#define CONTROL_B 3
#define LEDR 12
#define LEDG 11
#define LEDB 10
Adafruit_SSD1306 display(OLED_MOSI, OLED_CLK, OLED_DC, OLED_RESET, OLED_CS);
const int ledCount = 8; // the number of LEDs in the bar graph
int ledPins[] = {0,1,2,3,4,5,6,7};
int i=0;
unsigned long time;

static const unsigned char PROGMEM start[]= {
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B01111111, B00000111, B11111000, B00011100, B00000111, B11110000, B00111000, B00011100, 
  B01111111, B10000111, B11111000, B00011100, B00000111, B11111100, B00011100, B00011000, 
  B01100001, B11000110, B00000000, B00110110, B00000110, B00001111, B00001100, B00111000, 
  B01100000, B11000110, B00000000, B00110110, B00000110, B00000011, B00001110, B00110000, 
  B01100000, B11000110, B00000000, B00110110, B00000110, B00000011, B00000110, B01100000, 
  B01100000, B11000110, B00000000, B01110111, B00000110, B00000001, B10000110, B01100000, 
  B01100001, B10000110, B00000000, B01100011, B00000110, B00000001, B10000011, B11000000, 
  B01111111, B00000111, B11111000, B01100011, B00000110, B00000001, B10000011, B11000000, 
  B01111111, B00000111, B11111000, B11100011, B10000110, B00000001, B10000001, B10000000, 
  B01100011, B10000110, B00000000, B11111111, B10000110, B00000001, B10000001, B10000000, 
  B01100001, B10000110, B00000000, B11111111, B10000110, B00000001, B10000001, B10000000, 
  B01100001, B10000110, B00000000, B11000001, B10000110, B00000011, B00000001, B10000000, 
  B01100000, B11000110, B00000001, B11000001, B11000110, B00000111, B00000001, B10000000, 
  B01100000, B11000110, B00000001, B10000000, B11000110, B00001110, B00000001, B10000000, 
  B01100000, B11000111, B11111001, B10000000, B11000111, B11111100, B00000001, B10000000, 
  B01100000, B11000111, B11111011, B10000000, B11100111, B11110000, B00000001, B10000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  
};
static const unsigned char PROGMEM GO[]= {
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11110000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00001111, B11111000, B00001111, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00111100, B00001000, B00111100, B00111100, B00000000, B00000000, 
  B00000000, B00000000, B01111000, B00000000, B00111000, B00011100, B00000000, B00000000, 
  B00000000, B00000000, B11110000, B00000000, B01110000, B00001110, B00000000, B00000000, 
  B00000000, B00000000, B11100000, B00000000, B01110000, B00001110, B00000000, B00000000, 
  B00000000, B00000000, B11000000, B00000000, B01100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B00000000, B11100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B00000000, B11100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B11111100, B11100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B11111100, B11100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B00011100, B11100000, B00000111, B00000000, B00000000, 
  B00000000, B00000001, B11000000, B00011100, B11100000, B00000110, B00000000, B00000000, 
  B00000000, B00000000, B11100000, B00011100, B01110000, B00001110, B00000000, B00000000, 
  B00000000, B00000000, B11100000, B00011100, B01110000, B00001110, B00000000, B00000000, 
  B00000000, B00000000, B01110000, B00011100, B00111000, B00011100, B00000000, B00000000, 
  B00000000, B00000000, B00111100, B00011100, B00111100, B00111100, B00000000, B00000000, 
  B00000000, B00000000, B00011111, B11111100, B00001111, B11110000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11110000, B00000011, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
};
static const unsigned char PROGMEM Logo0[]={
    B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000111, B11100000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00011111, B11111000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B01111111, B11111100, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11111111, B11111110, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11111000, B00111111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11110000, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000111, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11000000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11110000, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11111000, B00111111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11111111, B11111110, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B01111111, B11111100, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00111111, B11110000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000111, B11000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
 
  };
static const unsigned char PROGMEM CLEAR[]={
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000,  
  };
  static const unsigned char PROGMEM Logo1[]={
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11110000, B00000111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11110000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11111000, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11111100, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B01111100, B00111110, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00111110, B00111100, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00111110, B01111100, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00011111, B01111000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000111, B11100000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000111, B11100000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000111, B11110000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00001111, B11110000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00011111, B11111000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00011110, B01111000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00111110, B01111100, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B01111100, B00111110, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B01111100, B00111110, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11111000, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B11110000, B00011111, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000001, B11110000, B00001111, B10000000, B00000000, B00000000, 
  B00000000, B00000000, B00000011, B11100000, B00001111, B11000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000,  
  };

static const unsigned char PROGMEM over[]  = {
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000001, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00100000, B00000000, B00000010, B00000000, B00000000, B00000000, B00000000, 
  B00000010, B00100000, B00000000, B00000010, B00000000, B00000000, B00000000, B00000000, 
  B00000010, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000111, B10100111, B10111000, B11100000, B01110000, B00000010, B00100101, B11000000, 
  B00000010, B00100100, B01000100, B10010000, B10000000, B00000010, B00100110, B01100000, 
  B00000010, B00100100, B01000101, B00010000, B11000000, B00000010, B00100100, B00100000, 
  B00000010, B00100100, B01000101, B11110000, B01100000, B00000010, B00100100, B00100000, 
  B00000010, B00100100, B01000101, B00000000, B00010000, B00000010, B00100100, B00100000, 
  B00000010, B00100100, B01000101, B10000000, B00010000, B00000010, B00100110, B01100000, 
  B00000011, B00100100, B01000100, B11110000, B11100000, B00000001, B11100101, B11000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000100, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000100, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000100, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, B00000000, 
  
};

void turnoff(){
  digitalWrite(LEDR, LOW);
  digitalWrite(LEDG, LOW);
  digitalWrite(LEDB, LOW);
}

void setup()
{
  Serial.begin(9600);
  display.begin(SSD1306_SWITCHCAPVCC);
  display.clearDisplay();
  
  pinMode(CONTROL_A, INPUT);
  pinMode(CONTROL_B, INPUT);
  
  display.drawBitmap(23,0,start,64,32,WHITE);
  display.display();
  
  pinMode(LEDR, OUTPUT);
  pinMode(LEDG, OUTPUT);
  pinMode(LEDB, OUTPUT);

  digitalWrite(LEDR, HIGH);
  delay(3000);
       
  display.clearDisplay();

  display.drawBitmap(23,0,GO,64,32,WHITE);
  display.display();
  
  turnoff();
  digitalWrite(LEDG, HIGH);
  delay(500);
  turnoff();
  
  display.clearDisplay();

  randomSeed(analogRead(0));
}

void loop()
{
  if(time<30000){
  time=millis();
  bool controlA=false;
  bool controlB=false;
  int randNumber=random(2);
  if(randNumber==0)
  {
    display.drawBitmap(23,0,Logo0,64,32,WHITE);
    display.display();
    while(controlA!=true){
      controlA=digitalRead(CONTROL_A);
      controlB=digitalRead(CONTROL_B);
      if(controlB==true)
      {
        i--;
        Serial.println(i);
        delay(200);
        }
      }
    if(controlA==true&&controlB!=true)
    {
      display.clearDisplay();
      display.drawBitmap(23,0,CLEAR,64,32,WHITE);
      display.display();
      i++;
      Serial.println(i);
      delay(200);
      }
  }
  else{
    display.drawBitmap(23,0,Logo1,64,32,WHITE);
    display.display();
    while(controlB!=true){
      controlA=digitalRead(CONTROL_A);
      controlB=digitalRead(CONTROL_B);
      if(controlA==true)
      {
        i--;
        Serial.println(i);
        delay(200);
        }
      }
    if(controlB==true&&controlA!=true)
    {
      display.clearDisplay();
      display.drawBitmap(23,0,CLEAR,64,32,WHITE);
      display.display();
      i++;
      Serial.println(i);
      delay(200);
      }
    }
  }
  else if(time<=32000){
  time=millis();
  display.clearDisplay();
  display.drawBitmap(23,0,over,64,32,WHITE);
  display.display();
  digitalWrite(LEDB, HIGH);
  delay(2000);
  turnoff();
  
  display.clearDisplay();
  }
}
